<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Symmetric Matrices</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../Blaze.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blaze.jpg"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Symmetric Matrices </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#adaptors_symmetric_matrices_general">Symmetric Matrices</a></li>
<li class="level1"><a href="#adaptors_symmetric_matrices_symmetricmatrix">SymmetricMatrix</a></li>
<li class="level1"><a href="#adaptors_symmetric_matrices_special_properties">Special Properties of Symmetric Matrices</a><ul><li class="level2"><a href="#adaptors_symmetric_matrices_square">Symmetric Matrices Must Always be Square!</a></li>
<li class="level2"><a href="#adaptors_symmetric_matrices_symmetry">The Symmetric Property is Always Enforced!</a></li>
<li class="level2"><a href="#adaptors_symmetric_matrices_initialization">The Elements of a Dense Symmetric Matrix are Always Default Initialized!</a></li>
</ul>
</li>
<li class="level1"><a href="#adaptors_symmetric_matrices_arithmetic_operations">Arithmetic Operations</a></li>
<li class="level1"><a href="#adaptors_symmetric_matrices_block_matrices">Symmetric Block Matrices</a></li>
<li class="level1"><a href="#adaptors_symmetric_matrices_performance">Performance Considerations</a><ul><li class="level2"><a href="#adaptors_symmetric_matrices_matrix_matrix_multiplication">Positive Impact: Matrix/Matrix Multiplication</a></li>
<li class="level2"><a href="#adaptors_symmetric_matrices_matrix_vector_multiplication">Positive Impact: Matrix/Vector Multiplication</a></li>
<li class="level2"><a href="#adaptors_symmetric_matrices_views">Positive Impact: Row/Column Views on Column/Row-Major Matrices</a></li>
<li class="level2"><a href="#adaptors_symmetric_matrices_assignment">Negative Impact: Assignment of a General Matrix</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><br />
 </p>
<h1><a class="anchor" id="adaptors_symmetric_matrices_general"></a>
Symmetric Matrices</h1>
<hr/>
<p>In contrast to general matrices, which have no restriction in their number of rows and columns and whose elements can have any value, symmetric matrices provide the compile time guarantee to be square matrices with pair-wise identical values. Mathematically, this means that a symmetric matrix is always equal to its transpose ( <img class="formulaInl" alt="$ A = A^T $" src="../../form_23.png"/>) and that all non-diagonal values have an identical counterpart ( <img class="formulaInl" alt="$ a_{ij} == a_{ji} $" src="../../form_177.png"/>). This symmetry property can be exploited to provide higher efficiency and/or lower memory consumption. Within the <b>Blaze</b> library, symmetric matrices are realized by the <a class="el" href="../../da/db8/adaptors_symmetric_matrices.html#adaptors_symmetric_matrices_symmetricmatrix">SymmetricMatrix</a> class template.</p>
<p><br />
 </p>
<h1><a class="anchor" id="adaptors_symmetric_matrices_symmetricmatrix"></a>
SymmetricMatrix</h1>
<hr/>
<p>The SymmetricMatrix class template is an adapter for existing dense and sparse matrix types. It inherits the properties and the interface of the given matrix type <code>MT</code> and extends it by enforcing the additional invariant of symmetry (i.e. the matrix is always equal to its transpose <img class="formulaInl" alt="$ A = A^T $" src="../../form_23.png"/>). It can be included via the header file</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../dd/da7/SymmetricMatrix_8h.html">blaze/math/SymmetricMatrix.h</a>&gt;</span></div></div><!-- fragment --><p>The type of the adapted matrix can be specified via template parameter:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt; <span class="keyword">typename</span> MT &gt;</div><div class="line"><span class="keyword">class </span>SymmetricMatrix;</div></div><!-- fragment --><p><code>MT</code> specifies the type of the matrix to be adapted. SymmetricMatrix can be used with any non-cv-qualified, non-reference, non-pointer, non-expression dense or sparse matrix type. Note that the given matrix type must be either resizable (as for instance <a class="el" href="../../d6/d60/classblaze_1_1HybridMatrix.html" title="Efficient implementation of a dynamically sized matrix with static memory.The HybridMatrix class temp...">blaze::HybridMatrix</a> or <a class="el" href="../../de/d1e/classblaze_1_1DynamicMatrix.html" title="Efficient implementation of a dynamic  matrix.The DynamicMatrix class template is the representation ...">blaze::DynamicMatrix</a>) or must be square at compile time (as for instance <a class="el" href="../../d3/dd3/classblaze_1_1StaticMatrix.html" title="Efficient implementation of a fixed-sized matrix.The StaticMatrix class template is the representatio...">blaze::StaticMatrix</a>).</p>
<p>The following examples give an impression of several possible symmetric matrices:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#gaa4c0db94efdf35b9bf1834ace9c48177">blaze::unaligned</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#ga1858f68dbe5aba0ded4e45358324e3a1">blaze::unpadded</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a5e42e1508f7d4d364fe7c64eef78a583">blaze::columnMajor</a>;</div><div class="line"></div><div class="line"><span class="comment">// Definition of a 3x3 row-major dense symmetric matrix with static memory</span></div><div class="line"><a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix&lt; blaze::StaticMatrix&lt;int,3UL,3UL,rowMajor&gt;</a> &gt; A;</div><div class="line"></div><div class="line"><span class="comment">// Definition of a resizable column-major dense symmetric matrix based on HybridMatrix</span></div><div class="line"><a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix&lt; blaze::HybridMatrix&lt;float,4UL,4UL,columnMajor&gt;</a> B;</div><div class="line"></div><div class="line"><span class="comment">// Definition of a resizable row-major dense symmetric matrix based on DynamicMatrix</span></div><div class="line"><a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix&lt; blaze::DynamicMatrix&lt;double,rowMajor&gt;</a> &gt; C;</div><div class="line"></div><div class="line"><span class="comment">// Definition of a fixed size row-major dense symmetric matrix based on CustomMatrix</span></div><div class="line"><a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix&lt; blaze::CustomMatrix&lt;double,unaligned,unpadded,rowMajor&gt;</a> &gt; D;</div><div class="line"></div><div class="line"><span class="comment">// Definition of a compressed row-major single precision symmetric matrix</span></div><div class="line"><a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix&lt; blaze::CompressedMatrix&lt;float,blaze::rowMajor&gt;</a> &gt; E;</div></div><!-- fragment --><p>The storage order of a symmetric matrix is depending on the storage order of the adapted matrix type <code>MT</code>. In case the adapted matrix is stored in a row-wise fashion (i.e. is specified as <a class="el" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa" title="Storage order flag for row-major matrices. ">blaze::rowMajor</a>), the symmetric matrix will also be a row-major matrix. Otherwise, if the adapted matrix is column-major (i.e. is specified as <a class="el" href="../../d2/de9/namespaceblaze.html#a5e42e1508f7d4d364fe7c64eef78a583" title="Storage order flag for column-major matrices. ">blaze::columnMajor</a>), the symmetric matrix will also be a column-major matrix.</p>
<p><br />
 </p>
<h1><a class="anchor" id="adaptors_symmetric_matrices_special_properties"></a>
Special Properties of Symmetric Matrices</h1>
<hr/>
<p>A symmetric matrix is used exactly like a matrix of the underlying, adapted matrix type <code>MT</code>. It also provides (nearly) the same interface as the underlying matrix type. However, there are some important exceptions resulting from the symmetry constraint:</p>
<ol type="1">
<li><b><a class="el" href="../../da/db8/adaptors_symmetric_matrices.html#adaptors_symmetric_matrices_square">Symmetric Matrices Must Always be Square!</a></b></li>
<li><b><a class="el" href="../../da/db8/adaptors_symmetric_matrices.html#adaptors_symmetric_matrices_symmetry">The Symmetric Property is Always Enforced!</a></b></li>
<li><b><a class="el" href="../../da/db8/adaptors_symmetric_matrices.html#adaptors_symmetric_matrices_initialization">The Elements of a Dense Symmetric Matrix are Always Default Initialized!</a></b></li>
</ol>
<p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_square"></a>
Symmetric Matrices Must Always be Square!</h2>
<p>In case a resizable matrix is used (as for instance <a class="el" href="../../d6/d60/classblaze_1_1HybridMatrix.html" title="Efficient implementation of a dynamically sized matrix with static memory.The HybridMatrix class temp...">blaze::HybridMatrix</a>, <a class="el" href="../../de/d1e/classblaze_1_1DynamicMatrix.html" title="Efficient implementation of a dynamic  matrix.The DynamicMatrix class template is the representation ...">blaze::DynamicMatrix</a>, or <a class="el" href="../../da/d7a/classblaze_1_1CompressedMatrix.html" title="Efficient implementation of a  compressed matrix.The CompressedMatrix class template is the represent...">blaze::CompressedMatrix</a>), this means that the according constructors, the <code><a class="el" href="../../dd/d7a/group__matrix.html#ga651c6be92e3a13425c42f3d92cf309fc" title="Changing the size of the matrix. ">resize()</a></code> and the <code>extend()</code> functions only expect a single parameter, which specifies both the number of rows and columns, instead of two (one for the number of rows and one for the number of columns):</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"></div><div class="line"><span class="comment">// Default constructed, default initialized, row-major 3x3 symmetric dynamic matrix</span></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double,rowMajor&gt; &gt; A( 3 );</div><div class="line"></div><div class="line"><span class="comment">// Resizing the matrix to 5x5</span></div><div class="line">A.resize( 5 );</div><div class="line"></div><div class="line"><span class="comment">// Extending the number of rows and columns by 2, resulting in a 7x7 matrix</span></div><div class="line">A.extend( 2 );</div></div><!-- fragment --><p>In case a matrix with a fixed size is used (as for instance <a class="el" href="../../d3/dd3/classblaze_1_1StaticMatrix.html" title="Efficient implementation of a fixed-sized matrix.The StaticMatrix class template is the representatio...">blaze::StaticMatrix</a>), the number of rows and number of columns must be specified equally:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../d3/dd3/classblaze_1_1StaticMatrix.html">blaze::StaticMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a5e42e1508f7d4d364fe7c64eef78a583">blaze::columnMajor</a>;</div><div class="line"></div><div class="line"><span class="comment">// Correct setup of a fixed size column-major 3x3 symmetric static matrix</span></div><div class="line">SymmetricMatrix&lt; StaticMatrix&lt;int,3UL,3UL,columnMajor&gt; &gt; A;</div><div class="line"></div><div class="line"><span class="comment">// Compilation error: the provided matrix type is not a square matrix type</span></div><div class="line">SymmetricMatrix&lt; StaticMatrix&lt;int,3UL,4UL,columnMajor&gt; &gt; B;</div></div><!-- fragment --><p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_symmetry"></a>
The Symmetric Property is Always Enforced!</h2>
<p>This means that modifying the element <img class="formulaInl" alt="$ a_{ij} $" src="../../form_24.png"/> of a symmetric matrix also modifies its counterpart element <img class="formulaInl" alt="$ a_{ji} $" src="../../form_25.png"/>. Also, it is only possible to assign matrices that are symmetric themselves:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d3/dd3/classblaze_1_1StaticMatrix.html">blaze::StaticMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"></div><div class="line"><span class="comment">// Default constructed, row-major 3x3 symmetric compressed matrix</span></div><div class="line">SymmetricMatrix&lt; CompressedMatrix&lt;double,rowMajor&gt; &gt; A( 3 );</div><div class="line"></div><div class="line"><span class="comment">// Initializing three elements via the function call operator</span></div><div class="line">A(0,0) = 1.0;  <span class="comment">// Initialization of the diagonal element (0,0)</span></div><div class="line">A(0,2) = 2.0;  <span class="comment">// Initialization of the elements (0,2) and (2,0)</span></div><div class="line"></div><div class="line"><span class="comment">// Inserting three more elements via the insert() function</span></div><div class="line">A.insert( 1, 1, 3.0 );  <span class="comment">// Inserting the diagonal element (1,1)</span></div><div class="line">A.insert( 1, 2, 4.0 );  <span class="comment">// Inserting the elements (1,2) and (2,1)</span></div><div class="line"></div><div class="line"><span class="comment">// Access via a non-const iterator</span></div><div class="line">*A.begin(1UL) = 10.0;  <span class="comment">// Modifies both elements (1,0) and (0,1)</span></div><div class="line"></div><div class="line"><span class="comment">// Erasing elements via the erase() function</span></div><div class="line">A.erase( 0, 0 );  <span class="comment">// Erasing the diagonal element (0,0)</span></div><div class="line">A.erase( 0, 2 );  <span class="comment">// Erasing the elements (0,2) and (2,0)</span></div><div class="line"></div><div class="line"><span class="comment">// Construction from a symmetric dense matrix</span></div><div class="line">StaticMatrix&lt;double,3UL,3UL&gt; B{ {  3.0,  8.0, -2.0 },</div><div class="line">                                {  8.0,  0.0, -1.0 },</div><div class="line">                                { -2.0, -1.0,  4.0 } };</div><div class="line"></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double,rowMajor&gt; &gt; C( B );  <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="comment">// Assignment of a non-symmetric dense matrix</span></div><div class="line">StaticMatrix&lt;double,3UL,3UL&gt; D{ {  3.0,  7.0, -2.0 },</div><div class="line">                                {  8.0,  0.0, -1.0 },</div><div class="line">                                {Â -2.0, -1.0,  4.0 } };</div><div class="line"></div><div class="line">C = D;  <span class="comment">// Throws an exception; symmetric invariant would be violated!</span></div></div><!-- fragment --><p>The same restriction also applies to the <code>append()</code> function for sparse matrices: Appending the element <img class="formulaInl" alt="$ a_{ij} $" src="../../form_24.png"/> additionally inserts the element <img class="formulaInl" alt="$ a_{ji} $" src="../../form_25.png"/> into the matrix. Despite the additional insertion, the <code>append()</code> function still provides the most efficient way to set up a symmetric sparse matrix. In order to achieve the maximum efficiency, the capacity of the individual rows/columns of the matrix should to be specifically prepared with <code>reserve()</code> calls:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"></div><div class="line"><span class="comment">// Setup of the symmetric matrix</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       ( 0 1 3 )</span></div><div class="line"><span class="comment">//   A = ( 1 2 0 )</span></div><div class="line"><span class="comment">//       ( 3 0 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line">SymmetricMatrix&lt; CompressedMatrix&lt;double,rowMajor&gt; &gt; A( 3 );</div><div class="line"></div><div class="line">A.reserve( 5 );         <span class="comment">// Reserving enough space for 5 non-zero elements</span></div><div class="line">A.reserve( 0, 2 );      <span class="comment">// Reserving two non-zero elements in the first row</span></div><div class="line">A.reserve( 1, 2 );      <span class="comment">// Reserving two non-zero elements in the second row</span></div><div class="line">A.reserve( 2, 1 );      <span class="comment">// Reserving a single non-zero element in the third row</span></div><div class="line">A.append( 0, 1, 1.0 );  <span class="comment">// Appending the value 1 at position (0,1) and (1,0)</span></div><div class="line">A.append( 1, 1, 2.0 );  <span class="comment">// Appending the value 2 at position (1,1)</span></div><div class="line">A.append( 2, 0, 3.0 );  <span class="comment">// Appending the value 3 at position (2,0) and (0,2)</span></div></div><!-- fragment --><p>The symmetry property is also enforced for symmetric custom matrices: In case the given array of elements does not represent a symmetric matrix, a <code>std::invalid_argument</code> exception is thrown:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d43/classblaze_1_1CustomMatrix.html">blaze::CustomMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#gaa4c0db94efdf35b9bf1834ace9c48177">blaze::unaligned</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#ga1858f68dbe5aba0ded4e45358324e3a1">blaze::unpadded</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> SymmetricMatrix&lt; CustomMatrix&lt;double,unaligned,unpadded,rowMajor&gt; &gt;  CustomSymmetric;</div><div class="line"></div><div class="line"><span class="comment">// Creating a 3x3 symmetric custom matrix from a properly initialized array</span></div><div class="line"><span class="keywordtype">double</span> array[9] = { 1.0, 2.0, 4.0,</div><div class="line">                    2.0, 3.0, 5.0,</div><div class="line">                    4.0, 5.0, 6.0 };</div><div class="line">CustomSymmetric A( array, 3UL );  <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="comment">// Attempt to create a second 3x3 symmetric custom matrix from an uninitialized array</span></div><div class="line">CustomSymmetric B( <span class="keyword">new</span> <span class="keywordtype">double</span>[9UL], 3UL, <a class="code" href="../../d0/d60/structblaze_1_1ArrayDelete.html">blaze::ArrayDelete</a>() );  <span class="comment">// Throws an exception</span></div></div><!-- fragment --><p>Finally, the symmetry property is enforced for views (rows, columns, submatrices, ...) on the symmetric matrix. The following example demonstrates that modifying the elements of an entire row of the symmetric matrix also affects the counterpart elements in the according column of the matrix:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"></div><div class="line"><span class="comment">// Setup of the symmetric matrix</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       ( 0 1 0 2 )</span></div><div class="line"><span class="comment">//   A = ( 1 3 4 0 )</span></div><div class="line"><span class="comment">//       ( 0 4 0 5 )</span></div><div class="line"><span class="comment">//       ( 2 0 5 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;int&gt; &gt; A( 4 );</div><div class="line">A(0,1) = 1;</div><div class="line">A(0,3) = 2;</div><div class="line">A(1,1) = 3;</div><div class="line">A(1,2) = 4;</div><div class="line">A(2,3) = 5;</div><div class="line"></div><div class="line"><span class="comment">// Setting all elements in the 1st row to 0 results in the matrix</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       ( 0 0 0 2 )</span></div><div class="line"><span class="comment">//   A = ( 0 0 0 0 )</span></div><div class="line"><span class="comment">//       ( 0 0 0 5 )</span></div><div class="line"><span class="comment">//       ( 2 0 5 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga062bf148d887c56afde41f4649897dbe">row</a>( A, 1 ) = 0;</div></div><!-- fragment --><p>The next example demonstrates the (compound) assignment to submatrices of symmetric matrices. Since the modification of element <img class="formulaInl" alt="$ a_{ij} $" src="../../form_24.png"/> of a symmetric matrix also modifies the element <img class="formulaInl" alt="$ a_{ji} $" src="../../form_25.png"/>, the matrix to be assigned must be structured such that the symmetry of the symmetric matrix is preserved. Otherwise a <code>std::invalid_argument</code> exception is thrown:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"></div><div class="line"><span class="comment">// Setup of two default 4x4 symmetric matrices</span></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;int&gt; &gt; A1( 4 ), A2( 4 );</div><div class="line"></div><div class="line"><span class="comment">// Setup of the 3x2 dynamic matrix</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       ( 1 2 )</span></div><div class="line"><span class="comment">//   B = ( 3 4 )</span></div><div class="line"><span class="comment">//       ( 5 6 )</span></div><div class="line"><span class="comment">//</span></div><div class="line">DynamicMatrix&lt;int&gt; B{ { 1, 2 }, { 3, 4 }, { 5, 6 } };</div><div class="line"></div><div class="line"><span class="comment">// OK: Assigning B to a submatrix of A1 such that the symmetry can be preserved</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//        ( 0 0 1 2 )</span></div><div class="line"><span class="comment">//   A1 = ( 0 0 3 4 )</span></div><div class="line"><span class="comment">//        ( 1 3 5 6 )</span></div><div class="line"><span class="comment">//        ( 2 4 6 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A1, 0UL, 2UL, 3UL, 2UL ) = B;  <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="comment">// Error: Assigning B to a submatrix of A2 such that the symmetry cannot be preserved!</span></div><div class="line"><span class="comment">//   The elements marked with X cannot be assigned unambiguously!</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//        ( 0 1 2 0 )</span></div><div class="line"><span class="comment">//   A2 = ( 1 3 X 0 )</span></div><div class="line"><span class="comment">//        ( 2 X 6 0 )</span></div><div class="line"><span class="comment">//        ( 0 0 0 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A2, 0UL, 1UL, 3UL, 2UL ) = B;  <span class="comment">// Assignment throws an exception!</span></div></div><!-- fragment --><p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_initialization"></a>
The Elements of a Dense Symmetric Matrix are Always Default Initialized!</h2>
<p>Although this results in a small loss of efficiency (especially in case all default values are overridden afterwards), this property is important since otherwise the symmetric property of dense symmetric matrices could not be guaranteed:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"></div><div class="line"><span class="comment">// Uninitialized, 5x5 row-major dynamic matrix</span></div><div class="line">DynamicMatrix&lt;int,rowMajor&gt; A( 5, 5 );</div><div class="line"></div><div class="line"><span class="comment">// Default initialized, 5x5 row-major symmetric dynamic matrix</span></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;int,rowMajor&gt; &gt; B( 5 );</div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="adaptors_symmetric_matrices_arithmetic_operations"></a>
Arithmetic Operations</h1>
<hr/>
<p>A SymmetricMatrix matrix can participate in numerical operations in any way any other dense or sparse matrix can participate. It can also be combined with any other dense or sparse vector or matrix. The following code example gives an impression of the use of SymmetricMatrix within arithmetic operations:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d6/d60/classblaze_1_1HybridMatrix.html">blaze::HybridMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d3/dd3/classblaze_1_1StaticMatrix.html">blaze::StaticMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a5e42e1508f7d4d364fe7c64eef78a583">blaze::columnMajor</a>;</div><div class="line"></div><div class="line">DynamicMatrix&lt;double,rowMajor&gt; A( 3, 3 );</div><div class="line">CompressedMatrix&lt;double,rowMajor&gt; B( 3, 3 );</div><div class="line"></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double,rowMajor&gt; &gt; C( 3 );</div><div class="line">SymmetricMatrix&lt; CompressedMatrix&lt;double,rowMajor&gt; &gt; D( 3 );</div><div class="line"></div><div class="line">SymmetricMatrix&lt; HybridMatrix&lt;float,3UL,3UL,rowMajor&gt; &gt; E;</div><div class="line">SymmetricMatrix&lt; StaticMatrix&lt;float,3UL,3UL,columnMajor&gt; &gt; F;</div><div class="line"></div><div class="line">E = A + B;     <span class="comment">// Matrix addition and assignment to a row-major symmetric matrix (includes runtime check)</span></div><div class="line">F = C - D;     <span class="comment">// Matrix subtraction and assignment to a column-major symmetric matrix (only compile time check)</span></div><div class="line">F = A * D;     <span class="comment">// Matrix multiplication between a dense and a sparse matrix (includes runtime check)</span></div><div class="line"></div><div class="line">C *= 2.0;      <span class="comment">// In-place scaling of matrix C</span></div><div class="line">E  = 2.0 * B;  <span class="comment">// Scaling of matrix B (includes runtime check)</span></div><div class="line">F  = C * 2.0;  <span class="comment">// Scaling of matrix C (only compile time check)</span></div><div class="line"></div><div class="line">E += A - B;    <span class="comment">// Addition assignment (includes runtime check)</span></div><div class="line">F -= C + D;    <span class="comment">// Subtraction assignment (only compile time check)</span></div><div class="line">F *= A * D;    <span class="comment">// Multiplication assignment (includes runtime check)</span></div></div><!-- fragment --><p>Note that it is possible to assign any kind of matrix to a symmetric matrix. In case the matrix to be assigned is not symmetric at compile time, a runtime check is performed.</p>
<p><br />
 </p>
<h1><a class="anchor" id="adaptors_symmetric_matrices_block_matrices"></a>
Symmetric Block Matrices</h1>
<hr/>
<p>It is also possible to use symmetric block matrices:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d3/dd3/classblaze_1_1StaticMatrix.html">blaze::StaticMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"></div><div class="line"><span class="comment">// Definition of a 3x3 symmetric block matrix based on CompressedMatrix</span></div><div class="line">SymmetricMatrix&lt; CompressedMatrix&lt; StaticMatrix&lt;int,3UL,3UL&gt; &gt; &gt; A( 3 );</div></div><!-- fragment --><p>Also in this case, the SymmetricMatrix class template enforces the invariant of symmetry and guarantees that a modifications of element <img class="formulaInl" alt="$ a_{ij} $" src="../../form_24.png"/> of the adapted matrix is also applied to element <img class="formulaInl" alt="$ a_{ji} $" src="../../form_25.png"/>:</p>
<div class="fragment"><div class="line"><span class="comment">// Inserting the elements (2,4) and (4,2)</span></div><div class="line">A.insert( 2, 4, StaticMatrix&lt;int,3UL,3UL&gt;{ { 1, -4,  5 },</div><div class="line">                                           { 6,  8, -3 },</div><div class="line">                                           { 2, -1,  2 } } );</div><div class="line"></div><div class="line"><span class="comment">// Manipulating the elements (2,4) and (4,2)</span></div><div class="line">A(2,4)(1,1) = -5;</div></div><!-- fragment --><p>For more information on block matrices, see the tutorial on <a class="el" href="../../de/d51/block_vectors_and_matrices.html">Block Vectors and Matrices</a>.</p>
<p><br />
 </p>
<h1><a class="anchor" id="adaptors_symmetric_matrices_performance"></a>
Performance Considerations</h1>
<hr/>
<p>When the symmetric property of a matrix is known beforehands using the SymmetricMatrix adaptor instead of a general matrix can be a considerable performance advantage. The <b>Blaze</b> library tries to exploit the properties of symmetric matrices whenever possible. However, there are also situations when using a symmetric matrix introduces some overhead. The following examples demonstrate several situations where symmetric matrices can positively or negatively impact performance.</p>
<p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_matrix_matrix_multiplication"></a>
Positive Impact: Matrix/Matrix Multiplication</h2>
<p>When multiplying two matrices, at least one of which is symmetric, <b>Blaze</b> can exploit the fact that <img class="formulaInl" alt="$ A = A^T $" src="../../form_23.png"/> and choose the fastest and most suited combination of storage orders for the multiplication. The following example demonstrates this by means of a dense matrix/sparse matrix multiplication:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a5e42e1508f7d4d364fe7c64eef78a583">blaze::columnMajor</a>;</div><div class="line"></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double,rowMajor&gt; &gt; A;</div><div class="line">SymmetricMatrix&lt; CompressedMatrix&lt;double,columnMajor&gt; &gt; B;</div><div class="line">DynamicMatrix&lt;double,columnMajor&gt; C;</div><div class="line"></div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line">C = A * B;</div></div><!-- fragment --><p>Intuitively, the chosen combination of a row-major and a column-major matrix is the most suited for maximum performance. However, <b>Blaze</b> evaluates the multiplication as</p>
<div class="fragment"><div class="line">C = A * <a class="code" href="../../db/df0/group__dense__matrix.html#ga89e370b7fc394ce8cbb51b0114509b08">trans</a>( B );</div></div><!-- fragment --><p>which significantly increases the performance since in contrast to the original formulation the optimized form can be vectorized. Therefore, in the context of matrix multiplications, using the SymmetricMatrix adapter is obviously an advantage.</p>
<p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_matrix_vector_multiplication"></a>
Positive Impact: Matrix/Vector Multiplication</h2>
<p>A similar optimization is possible in case of matrix/vector multiplications:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../da/d9e/classblaze_1_1DynamicVector.html">blaze::DynamicVector</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d5/d35/classblaze_1_1CompressedVector.html">blaze::CompressedVector</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#acee466faebcaba59afde0fbfe22041aa">blaze::columnVector</a>;</div><div class="line"></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double,rowMajor&gt; &gt; A;</div><div class="line">CompressedVector&lt;double,columnVector&gt; x;</div><div class="line">DynamicVector&lt;double,columnVector&gt; y;</div><div class="line"></div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line">y = A * x;</div></div><!-- fragment --><p>In this example it is not intuitively apparent that using a row-major matrix is not the best possible choice in terms of performance since the computation cannot be vectorized. Choosing a column-major matrix instead, however, would enable a vectorized computation. Therefore <b>Blaze</b> exploits the fact that <code>A</code> is symmetric, selects the best suited storage order and evaluates the multiplication as</p>
<div class="fragment"><div class="line">y = <a class="code" href="../../db/df0/group__dense__matrix.html#ga89e370b7fc394ce8cbb51b0114509b08">trans</a>( A ) * x;</div></div><!-- fragment --><p>which also significantly increases the performance.</p>
<p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_views"></a>
Positive Impact: Row/Column Views on Column/Row-Major Matrices</h2>
<p>Another example is the optimization of a row view on a column-major symmetric matrix:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/d67/classblaze_1_1Row.html">blaze::Row</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a5e42e1508f7d4d364fe7c64eef78a583">blaze::columnMajor</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> SymmetricMatrix&lt; DynamicMatrix&lt;double,columnMajor&gt; &gt;  DynamicSymmetric;</div><div class="line"></div><div class="line">DynamicSymmetric A( 10UL );</div><div class="line">Row&lt;DynamicSymmetric&gt; row5 = <a class="code" href="../../d0/d48/group__views.html#ga062bf148d887c56afde41f4649897dbe">row</a>( A, 5UL );</div></div><!-- fragment --><p>Usually, a row view on a column-major matrix results in a considerable performance decrease in comparison to a row view on a row-major matrix due to the non-contiguous storage of the matrix elements. However, in case of symmetric matrices, <b>Blaze</b> instead uses the according column of the matrix, which provides the same performance as if the matrix would be row-major. Note that this also works for column views on row-major matrices, where <b>Blaze</b> can use the according row instead of a column in order to provide maximum performance.</p>
<p><br />
 </p>
<h2><a class="anchor" id="adaptors_symmetric_matrices_assignment"></a>
Negative Impact: Assignment of a General Matrix</h2>
<p>In contrast to using a symmetric matrix on the right-hand side of an assignment (i.e. for read access), which introduces absolutely no performance penalty, using a symmetric matrix on the left-hand side of an assignment (i.e. for write access) may introduce additional overhead when it is assigned a general matrix, which is not symmetric at compile time:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double&gt; &gt; A, C;</div><div class="line">DynamicMatrix&lt;double&gt; B;</div><div class="line"></div><div class="line">B = A;  <span class="comment">// Only read-access to the symmetric matrix; no performance penalty</span></div><div class="line">C = A;  <span class="comment">// Assignment of a symmetric matrix to another symmetric matrix; no runtime overhead</span></div><div class="line">C = B;  <span class="comment">// Assignment of a general matrix to a symmetric matrix; some runtime overhead</span></div></div><!-- fragment --><p>When assigning a general, potentially not symmetric matrix to a symmetric matrix it is necessary to check whether the matrix is symmetric at runtime in order to guarantee the symmetry property of the symmetric matrix. In case it turns out to be symmetric, it is assigned as efficiently as possible, if it is not, an exception is thrown. In order to prevent this runtime overhead it is therefore generally advisable to assign symmetric matrices to other symmetric matrices.<br />
In this context it is especially noteworthy that in contrast to additions and subtractions the multiplication of two symmetric matrices does not necessarily result in another symmetric matrix:</p>
<div class="fragment"><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;double&gt; &gt; A, B, C;</div><div class="line"></div><div class="line">C = A + B;  <span class="comment">// Results in a symmetric matrix; no runtime overhead</span></div><div class="line">C = A - B;  <span class="comment">// Results in a symmetric matrix; no runtime overhead</span></div><div class="line">C = A * B;  <span class="comment">// Is not guaranteed to result in a symmetric matrix; some runtime overhead</span></div></div><!-- fragment --><p><br />
 Previous: <a class="el" href="../../d0/d34/adaptors.html">Adaptors</a> &#160; &#160; Next: <a class="el" href="../../de/d16/adaptors_hermitian_matrices.html">Hermitian Matrices</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 18 2017 05:50:23 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
