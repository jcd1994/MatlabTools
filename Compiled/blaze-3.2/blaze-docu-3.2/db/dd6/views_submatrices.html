<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Submatrices</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../Blaze.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../blaze.jpg"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Submatrices </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#views_submatrices_class">The Submatrix Class Template</a></li>
<li class="level1"><a href="#views_submatrices_setup">Setup of Submatrices</a></li>
<li class="level1"><a href="#views_submatrices_common_operations">Common Operations</a></li>
<li class="level1"><a href="#views_submatrices_element_access">Element Access</a></li>
<li class="level1"><a href="#views_submatrices_element_insertion">Element Insertion</a></li>
<li class="level1"><a href="#views_submatrices_arithmetic_operations">Arithmetic Operations</a></li>
<li class="level1"><a href="#views_aligned_submatrices">Aligned Submatrices</a></li>
<li class="level1"><a href="#views_submatrices_on_submatrices">Submatrices on Submatrices</a></li>
<li class="level1"><a href="#views_submatrices_on_symmetric_matrices">Submatrices on Symmetric Matrices</a></li>
</ul>
</div>
<div class="textblock"><p>Submatrices provide views on a specific part of a dense or sparse matrix just as subvectors provide views on specific parts of vectors. As such, submatrices act as a reference to a specific block within a matrix. This reference is valid and can be used in evary way any other dense or sparse matrix can be used as long as the matrix containing the submatrix is not resized or entirely destroyed. The submatrix also acts as an alias to the matrix elements in the specified block: Changes made to the elements (e.g. modifying values, inserting or erasing elements) are immediately visible in the matrix and changes made via the matrix are immediately visible in the submatrix.</p>
<p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_class"></a>
The Submatrix Class Template</h1>
<hr/>
<p>The <a class="el" href="../../d1/da2/classblaze_1_1Submatrix.html" title="View on a specific submatrix of a dense or sparse matrix.The Submatrix class template represents a vi...">blaze::Submatrix</a> class template represents a view on a specific submatrix of a dense or sparse matrix primitive. It can be included via the header file</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../df/de2/Submatrix_8h.html">blaze/math/Submatrix.h</a>&gt;</span></div></div><!-- fragment --><p>The type of the matrix is specified via two template parameters:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt; <span class="keyword">typename</span> MT, <span class="keywordtype">bool</span> AF &gt;</div><div class="line"><span class="keyword">class </span>Submatrix;</div></div><!-- fragment --><ul>
<li><code>MT:</code> specifies the type of the matrix primitive. Submatrix can be used with every matrix primitive, but does not work with any matrix expression type.</li>
<li><code>AF:</code> the alignment flag specifies whether the submatrix is aligned (<a class="el" href="../../de/df1/group__math.html#gac02fbb3ef9a09baf0b5e7b32a55cf6c7" title="Alignment flag for aligned vectors and matrices.Via this flag it is possible to specify subvectors...">blaze::aligned</a>) or unaligned (<a class="el" href="../../de/df1/group__math.html#gaa4c0db94efdf35b9bf1834ace9c48177" title="Alignment flag for unaligned vectors and matrices.Via this flag it is possible to specify subvectors...">blaze::unaligned</a>). The default value is <a class="el" href="../../de/df1/group__math.html#gaa4c0db94efdf35b9bf1834ace9c48177" title="Alignment flag for unaligned vectors and matrices.Via this flag it is possible to specify subvectors...">blaze::unaligned</a>.</li>
</ul>
<p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_setup"></a>
Setup of Submatrices</h1>
<hr/>
<p>A view on a submatrix can be created very conveniently via the <code><a class="el" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87" title="Creating a view on a specific submatrix of the given matrix. ">submatrix()</a></code> function. This view can be treated as any other matrix, i.e. it can be assigned to, it can be copied from, and it can be used in arithmetic operations. A submatrix created from a row-major matrix will itself be a row-major matrix, a submatrix created from a column-major matrix will be a column-major matrix. The view can also be used on both sides of an assignment: The submatrix can either be used as an alias to grant write access to a specific submatrix of a matrix primitive on the left-hand side of an assignment or to grant read-access to a specific submatrix of a matrix primitive or expression on the right-hand side of an assignment. The following example demonstrates this in detail:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;double,blaze::rowMajor&gt;</a>     DenseMatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d5/d35/classblaze_1_1CompressedVector.html">blaze::CompressedVector&lt;int,blaze::columnMajor&gt;</a>  SparseMatrixType;</div><div class="line"></div><div class="line">DenseMatrixType  D1, D2;</div><div class="line">SparseMatrixType S1, S2;</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a view on the first 8x16 block of the dense matrix D1</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;DenseMatrixType&gt;</a> dsm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 0UL, 0UL, 8UL, 16UL );</div><div class="line"></div><div class="line"><span class="comment">// Creating a view on the second 8x16 block of the sparse matrix S1</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;SparseMatrixType&gt;</a> ssm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( S1, 0UL, 16UL, 8UL, 16UL );</div><div class="line"></div><div class="line"><span class="comment">// Creating a view on the addition of D2 and S2</span></div><div class="line">dsm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D2 + S2, 5UL, 10UL, 8UL, 16UL );</div><div class="line"></div><div class="line"><span class="comment">// Creating a view on the multiplication of D2 and S2</span></div><div class="line">ssm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D2 * S2, 7UL, 13UL, 8UL, 16UL );</div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_common_operations"></a>
Common Operations</h1>
<hr/>
<p>The current size of the matrix, i.e. the number of rows or columns can be obtained via the <code><a class="el" href="../../dd/d7a/group__matrix.html#ga7b0c6e30994ba97cc2817a848355daf4" title="Returns the current number of rows of the matrix. ">rows()</a></code> and <code><a class="el" href="../../dd/d7a/group__matrix.html#ga43caf6f27a219eb68a76ebdf2550b62d" title="Returns the current number of columns of the matrix. ">columns()</a></code> functions, the current total capacity via the <code><a class="el" href="../../dd/d7a/group__matrix.html#ga41e8f2c5d0de752c667be20765570e56" title="Returns the maximum capacity of the matrix. ">capacity()</a></code> function, and the number of non-zero elements via the <code><a class="el" href="../../dd/d7a/group__matrix.html#ga2f34f7e65e4d2be9617f824285073923" title="Returns the total number of non-zero elements in the matrix. ">nonZeros()</a></code> function. However, since submatrices are views on a specific submatrix of a matrix, several operations are not possible on views, such as resizing and swapping:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;int,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a>               SubmatrixType;</div><div class="line"></div><div class="line">MatrixType A;</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a view on the a 8x12 submatrix of matrix A</span></div><div class="line">SubmatrixType sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 0UL, 0UL, 8UL, 12UL );</div><div class="line"></div><div class="line">sm.rows();      <span class="comment">// Returns the number of rows of the submatrix</span></div><div class="line">sm.columns();   <span class="comment">// Returns the number of columns of the submatrix</span></div><div class="line">sm.capacity();  <span class="comment">// Returns the capacity of the submatrix</span></div><div class="line">sm.nonZeros();  <span class="comment">// Returns the number of non-zero elements contained in the submatrix</span></div><div class="line"></div><div class="line">sm.resize( 10UL, 8UL );  <span class="comment">// Compilation error: Cannot resize a submatrix of a matrix</span></div><div class="line"></div><div class="line">SubmatrixType sm2 = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 8UL, 0UL, 12UL, 8UL );</div><div class="line"><a class="code" href="../../d0/d6e/group__compressed__matrix.html#ga72c078b1444dca25e2239357085649c3">swap</a>( sm, sm2 );  <span class="comment">// Compilation error: Swap operation not allowed</span></div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_element_access"></a>
Element Access</h1>
<hr/>
<p>The elements of a submatrix can be directly accessed with the function call operator:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;double,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line">MatrixType A;</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a 8x8 submatrix, starting from position (4,4)</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a> sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 4UL, 4UL, 8UL, 8UL );</div><div class="line"></div><div class="line"><span class="comment">// Setting the element (0,0) of the submatrix, which corresponds to</span></div><div class="line"><span class="comment">// the element at position (4,4) in matrix A</span></div><div class="line">sm(0,0) = 2.0;</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix&lt;double,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line">MatrixType A;</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a 8x8 submatrix, starting from position (4,4)</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a> sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 4UL, 4UL, 8UL, 8UL );</div><div class="line"></div><div class="line"><span class="comment">// Setting the element (0,0) of the submatrix, which corresponds to</span></div><div class="line"><span class="comment">// the element at position (4,4) in matrix A</span></div><div class="line">sm(0,0) = 2.0;</div></div><!-- fragment --><p>Alternatively, the elements of a submatrix can be traversed via (const) iterators. Just as with matrices, in case of non-const submatrices, <code><a class="el" href="../../dd/d7a/group__matrix.html#ga8f0c048c86b644d1b9be16edc43d1b99" title="Returns an iterator to the first element of row/column i. ">begin()</a></code> and <code><a class="el" href="../../dd/d7a/group__matrix.html#ga7fdc81bb7ed1970229a4f29afebfd7a6" title="Returns an iterator just past the last element of row/column i. ">end()</a></code> return an Iterator, which allows a manipulation of the non-zero values, in case of constant submatrices a ConstIterator is returned:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;int,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a>               SubmatrixType;</div><div class="line"></div><div class="line">MatrixType A( 256UL, 512UL );</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a reference to a specific submatrix of the dense matrix A</span></div><div class="line">SubmatrixType sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 16UL, 16UL, 64UL, 128UL );</div><div class="line"></div><div class="line"><span class="comment">// Traversing the elements of the 0th row via iterators to non-const elements</span></div><div class="line"><span class="keywordflow">for</span>( <a class="code" href="../../d2/de9/namespaceblaze.html#a8edd0302e146f39097a411783a7214f5">SubmatrixType::Iterator</a> it=sm.begin(0); it!=sm.end(0); ++it ) {</div><div class="line">   *it = ...;  <span class="comment">// OK: Write access to the dense submatrix value.</span></div><div class="line">   ... = *it;  <span class="comment">// OK: Read access to the dense submatrix value.</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Traversing the elements of the 1st row via iterators to const elements</span></div><div class="line"><span class="keywordflow">for</span>( <a class="code" href="../../d2/de9/namespaceblaze.html#a67e310139c2b875a90b3bfe6ba36a441">SubmatrixType::ConstIterator</a> it=sm.begin(1); it!=sm.end(1); ++it ) {</div><div class="line">   *it = ...;  <span class="comment">// Compilation error: Assignment to the value via a ConstIterator is invalid.</span></div><div class="line">   ... = *it;  <span class="comment">// OK: Read access to the dense submatrix value.</span></div><div class="line">}</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix&lt;int,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a>                  SubmatrixType;</div><div class="line"></div><div class="line">MatrixType A( 256UL, 512UL );</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a reference to a specific submatrix of the sparse matrix A</span></div><div class="line">SubmatrixType sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 16UL, 16UL, 64UL, 128UL );</div><div class="line"></div><div class="line"><span class="comment">// Traversing the elements of the 0th row via iterators to non-const elements</span></div><div class="line"><span class="keywordflow">for</span>( <a class="code" href="../../d2/de9/namespaceblaze.html#a8edd0302e146f39097a411783a7214f5">SubmatrixType::Iterator</a> it=sm.begin(0); it!=sm.end(0); ++it ) {</div><div class="line">   it-&gt;value() = ...;  <span class="comment">// OK: Write access to the value of the non-zero element.</span></div><div class="line">   ... = it-&gt;value();  <span class="comment">// OK: Read access to the value of the non-zero element.</span></div><div class="line">   it-&gt;index() = ...;  <span class="comment">// Compilation error: The index of a non-zero element cannot be changed.</span></div><div class="line">   ... = it-&gt;index();  <span class="comment">// OK: Read access to the index of the sparse element.</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Traversing the elements of the 1st row via iterators to const elements</span></div><div class="line"><span class="keywordflow">for</span>( <a class="code" href="../../d2/de9/namespaceblaze.html#a67e310139c2b875a90b3bfe6ba36a441">SubmatrixType::ConstIterator</a> it=sm.begin(1); it!=sm.end(1); ++it ) {</div><div class="line">   it-&gt;value() = ...;  <span class="comment">// Compilation error: Assignment to the value via a ConstIterator is invalid.</span></div><div class="line">   ... = it-&gt;value();  <span class="comment">// OK: Read access to the value of the non-zero element.</span></div><div class="line">   it-&gt;index() = ...;  <span class="comment">// Compilation error: The index of a non-zero element cannot be changed.</span></div><div class="line">   ... = it-&gt;index();  <span class="comment">// OK: Read access to the index of the sparse element.</span></div><div class="line">}</div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_element_insertion"></a>
Element Insertion</h1>
<hr/>
<p>Inserting/accessing elements in a sparse submatrix can be done by several alternative functions. The following example demonstrates all options:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix&lt;double,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line">MatrixType A( 256UL, 512UL );  <span class="comment">// Non-initialized matrix of size 256x512</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a>  SubmatrixType;</div><div class="line">SubmatrixType sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 10UL, 10UL, 16UL, 16UL );  <span class="comment">// View on a 16x16 submatrix of A</span></div><div class="line"></div><div class="line"><span class="comment">// The function call operator provides access to all possible elements of the sparse submatrix,</span></div><div class="line"><span class="comment">// including the zero elements. In case the subscript operator is used to access an element</span></div><div class="line"><span class="comment">// that is currently not stored in the sparse submatrix, the element is inserted into the</span></div><div class="line"><span class="comment">// submatrix.</span></div><div class="line">sm(2,4) = 2.0;</div><div class="line"></div><div class="line"><span class="comment">// The second operation for inserting elements is the set() function. In case the element is</span></div><div class="line"><span class="comment">// not contained in the submatrix it is inserted into the submatrix, if it is already contained</span></div><div class="line"><span class="comment">// in the submatrix its value is modified.</span></div><div class="line">sm.set( 2UL, 5UL, -1.2 );</div><div class="line"></div><div class="line"><span class="comment">// An alternative for inserting elements into the submatrix is the insert() function. However,</span></div><div class="line"><span class="comment">// it inserts the element only in case the element is not already contained in the submatrix.</span></div><div class="line">sm.insert( 2UL, 6UL, 3.7 );</div><div class="line"></div><div class="line"><span class="comment">// Just as in case of sparse matrices, elements can also be inserted via the append() function.</span></div><div class="line"><span class="comment">// In case of submatrices, append() also requires that the appended element&#39;s index is strictly</span></div><div class="line"><span class="comment">// larger than the currently largest non-zero index in the according row or column of the</span></div><div class="line"><span class="comment">// submatrix and that the according row&#39;s or column&#39;s capacity is large enough to hold the new</span></div><div class="line"><span class="comment">// element. Note however that due to the nature of a submatrix, which may be an alias to the</span></div><div class="line"><span class="comment">// middle of a sparse matrix, the append() function does not work as efficiently for a</span></div><div class="line"><span class="comment">// submatrix as it does for a matrix.</span></div><div class="line">sm.reserve( 2UL, 10UL );</div><div class="line">sm.append( 2UL, 10UL, -2.1 );</div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_arithmetic_operations"></a>
Arithmetic Operations</h1>
<hr/>
<p>Both dense and sparse submatrices can be used in all arithmetic operations that any other dense or sparse matrix can be used in. The following example gives an impression of the use of dense submatrices within arithmetic operations. All operations (addition, subtraction, multiplication, scaling, ...) can be performed on all possible combinations of dense and sparse matrices with fitting element types:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;double,blaze::rowMajor&gt;</a>     DenseMatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix&lt;double,blaze::rowMajor&gt;</a>  SparseMatrixType;</div><div class="line">DenseMatrixType D1, D2, D3;</div><div class="line">SparseMatrixType S1, S2;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d5/d35/classblaze_1_1CompressedVector.html">blaze::CompressedVector&lt;double,blaze::columnVector&gt;</a>  SparseVectorType;</div><div class="line">SparseVectorType a, b;</div><div class="line"></div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Submatrix&lt;DenseMatrixType&gt;  SubmatrixType;</div><div class="line">SubmatrixType sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 0UL, 0UL, 8UL, 8UL );  <span class="comment">// View on the 8x8 submatrix of matrix D1</span></div><div class="line">                                                         <span class="comment">// starting from row 0 and column 0</span></div><div class="line"></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 0UL, 8UL, 8UL, 8UL ) = D2;  <span class="comment">// Dense matrix initialization of the 8x8 submatrix</span></div><div class="line">                                           <span class="comment">// starting in row 0 and column 8</span></div><div class="line">sm = S1;                                   <span class="comment">// Sparse matrix initialization of the second 8x8 submatrix</span></div><div class="line"></div><div class="line">D3 = sm + D2;                                    <span class="comment">// Dense matrix/dense matrix addition</span></div><div class="line">S2 = S1  - <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 8UL, 0UL, 8UL, 8UL );  <span class="comment">// Sparse matrix/dense matrix subtraction</span></div><div class="line">D2 = sm * <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 8UL, 8UL, 8UL, 8UL );   <span class="comment">// Dense matrix/dense matrix multiplication</span></div><div class="line"></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 8UL, 0UL, 8UL, 8UL ) *= 2.0;      <span class="comment">// In-place scaling of a submatrix of D1</span></div><div class="line">D2 = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 8UL, 8UL, 8UL, 8UL ) * 2.0;  <span class="comment">// Scaling of the a submatrix of D1</span></div><div class="line">D2 = 2.0 * sm;                                   <span class="comment">// Scaling of the a submatrix of D1</span></div><div class="line"></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 0UL, 8UL, 8UL, 8UL ) += D2;  <span class="comment">// Addition assignment</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 8UL, 0UL, 8UL, 8UL ) -= S1;  <span class="comment">// Subtraction assignment</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 8UL, 8UL, 8UL, 8UL ) *= sm;  <span class="comment">// Multiplication assignment</span></div><div class="line"></div><div class="line">a = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 4UL, 4UL, 8UL, 8UL ) * b;  <span class="comment">// Dense matrix/sparse vector multiplication</span></div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_aligned_submatrices"></a>
Aligned Submatrices</h1>
<hr/>
<p>Usually submatrices can be defined anywhere within a matrix. They may start at any position and may have an arbitrary extension (only restricted by the extension of the underlying matrix). However, in contrast to matrices themselves, which are always properly aligned in memory and therefore can provide maximum performance, this means that submatrices in general have to be considered to be unaligned. This can be made explicit by the <a class="el" href="../../de/df1/group__math.html#gaa4c0db94efdf35b9bf1834ace9c48177" title="Alignment flag for unaligned vectors and matrices.Via this flag it is possible to specify subvectors...">blaze::unaligned</a> flag:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#gaa4c0db94efdf35b9bf1834ace9c48177">blaze::unaligned</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;double,blaze::rowMajor&gt;</a>  DenseMatrixType;</div><div class="line"></div><div class="line">DenseMatrixType A;</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Identical creations of an unaligned submatrix of size 8x8, starting in row 0 and column 0</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;DenseMatrixType&gt;</a>           sm1 = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>           ( A, 0UL, 0UL, 8UL, 8UL );</div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;DenseMatrixType&gt;</a>           sm2 = submatrix&lt;unaligned&gt;( A, 0UL, 0UL, 8UL, 8UL );</div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;DenseMatrixType,unaligned&gt;</a> sm3 = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>           ( A, 0UL, 0UL, 8UL, 8UL );</div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;DenseMatrixType,unaligned&gt;</a> sm4 = submatrix&lt;unaligned&gt;( A, 0UL, 0UL, 8UL, 8UL );</div></div><!-- fragment --><p>All of these calls to the <code><a class="el" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87" title="Creating a view on a specific submatrix of the given matrix. ">submatrix()</a></code> function are identical. Whether the alignment flag is explicitly specified or not, it always returns an unaligned submatrix. Whereas this may provide full flexibility in the creation of submatrices, this might result in performance disadvantages in comparison to matrix primitives (even in case the specified submatrix could be aligned). Whereas matrix primitives are guaranteed to be properly aligned and therefore provide maximum performance in all operations, a general view on a matrix might not be properly aligned. This may cause a performance penalty on some platforms and/or for some operations.</p>
<p>However, it is also possible to create aligned submatrices. Aligned submatrices are identical to unaligned submatrices in all aspects, except that they may pose additional alignment restrictions and therefore have less flexibility during creation, but don't suffer from performance penalties and provide the same performance as the underlying matrix. Aligned submatrices are created by explicitly specifying the <a class="el" href="../../de/df1/group__math.html#gac02fbb3ef9a09baf0b5e7b32a55cf6c7" title="Alignment flag for aligned vectors and matrices.Via this flag it is possible to specify subvectors...">blaze::aligned</a> flag:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#gac02fbb3ef9a09baf0b5e7b32a55cf6c7">blaze::aligned</a>;</div><div class="line"></div><div class="line"><span class="comment">// Creating an aligned submatrix of size 8x8, starting in row 0 and column 0</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;DenseMatrixType,aligned&gt;</a> sv = submatrix&lt;aligned&gt;( A, 0UL, 0UL, 8UL, 8UL );</div></div><!-- fragment --><p>The alignment restrictions refer to system dependent address restrictions for the used element type and the available vectorization mode (SSE, AVX, ...). In order to be properly aligned the first element of each row/column of the submatrix must be aligned. The following source code gives some examples for a double precision row-major dynamic matrix, assuming that padding is enabled and that AVX is available, which packs 4 <code>double</code> values into a SIMD vector:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#gac02fbb3ef9a09baf0b5e7b32a55cf6c7">blaze::aligned</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d2/de9/namespaceblaze.html#a511878ce70095271b6d0dd5b855a9eaa">blaze::rowMajor</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;double,rowMajor&gt;</a>  MatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType,aligned&gt;</a>   SubmatrixType;</div><div class="line"></div><div class="line">MatrixType D( 13UL, 17UL );</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// OK: Starts at position (0,0), i.e. the first element of each row is aligned (due to padding)</span></div><div class="line">SubmatrixType dsm1 = submatrix&lt;aligned&gt;( D, 0UL, 0UL, 7UL, 11UL );</div><div class="line"></div><div class="line"><span class="comment">// OK: First column is a multiple of 4, i.e. the first element of each row is aligned (due to padding)</span></div><div class="line">SubmatrixType dsm2 = submatrix&lt;aligned&gt;( D, 3UL, 12UL, 8UL, 16UL );</div><div class="line"></div><div class="line"><span class="comment">// OK: First column is a multiple of 4 and the submatrix includes the last row and column</span></div><div class="line">SubmatrixType dsm3 = submatrix&lt;aligned&gt;( D, 4UL, 0UL, 9UL, 17UL );</div><div class="line"></div><div class="line"><span class="comment">// Error: First column is not a multiple of 4, i.e. the first element is not aligned</span></div><div class="line">SubmatrixType dsm4 = submatrix&lt;aligned&gt;( D, 2UL, 3UL, 12UL, 12UL );</div></div><!-- fragment --><p>Note that the discussed alignment restrictions are only valid for aligned dense submatrices. In contrast, aligned sparse submatrices at this time don't pose any additional restrictions. Therefore aligned and unaligned sparse submatrices are truly fully identical. Still, in case the <a class="el" href="../../de/df1/group__math.html#gac02fbb3ef9a09baf0b5e7b32a55cf6c7" title="Alignment flag for aligned vectors and matrices.Via this flag it is possible to specify subvectors...">blaze::aligned</a> flag is specified during setup, an aligned submatrix is created:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/df1/group__math.html#gac02fbb3ef9a09baf0b5e7b32a55cf6c7">blaze::aligned</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../da/d7a/classblaze_1_1CompressedMatrix.html">blaze::CompressedMatrix&lt;double,blaze::rowMajor&gt;</a>  SparseMatrixType;</div><div class="line"></div><div class="line">SparseMatrixType A;</div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating an aligned submatrix of size 8x8, starting in row 0 and column 0</span></div><div class="line"><a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;SparseMatrixType,aligned&gt;</a> sv = submatrix&lt;aligned&gt;( A, 0UL, 0UL, 8UL, 8UL );</div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_on_submatrices"></a>
Submatrices on Submatrices</h1>
<hr/>
<p>It is also possible to create a submatrix view on another submatrix. In this context it is important to remember that the type returned by the <code><a class="el" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87" title="Creating a view on a specific submatrix of the given matrix. ">submatrix()</a></code> function is the same type as the type of the given submatrix, since the view on a submatrix is just another view on the underlying matrix:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix&lt;double,blaze::rowMajor&gt;</a>  MatrixType;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix&lt;MatrixType&gt;</a>                  SubmatrixType;</div><div class="line"></div><div class="line">MatrixType D1;</div><div class="line"></div><div class="line"><span class="comment">// ... Resizing and initialization</span></div><div class="line"></div><div class="line"><span class="comment">// Creating a submatrix view on the dense matrix D1</span></div><div class="line">SubmatrixType sm1 = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( D1, 4UL, 4UL, 8UL, 16UL );</div><div class="line"></div><div class="line"><span class="comment">// Creating a submatrix view on the dense submatrix sm1</span></div><div class="line">SubmatrixType sm2 = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( sm1, 1UL, 1UL, 4UL, 8UL );</div></div><!-- fragment --><p><br />
 </p>
<h1><a class="anchor" id="views_submatrices_on_symmetric_matrices"></a>
Submatrices on Symmetric Matrices</h1>
<p>Submatrices can also be created on symmetric matrices (see the <code>SymmetricMatrix</code> class template):</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d1/da2/classblaze_1_1Submatrix.html">blaze::Submatrix</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> SymmetricMatrix&lt; DynamicMatrix&lt;int&gt; &gt;  SymmetricDynamicType;</div><div class="line"><span class="keyword">typedef</span> Submatrix&lt; SymmetricDynamicType &gt;      SubmatrixType;</div><div class="line"></div><div class="line"><span class="comment">// Setup of a 16x16 symmetric matrix</span></div><div class="line">SymmetricDynamicType A( 16UL );</div><div class="line"></div><div class="line"><span class="comment">// Creating a dense submatrix of size 8x12, starting in row 2 and column 4</span></div><div class="line">SubmatrixType sm = <a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A, 2UL, 4UL, 8UL, 12UL );</div></div><!-- fragment --><p>It is important to note, however, that (compound) assignments to such submatrices have a special restriction: The symmetry of the underlying symmetric matrix must not be broken! Since the modification of element <img class="formulaInl" alt="$ a_{ij} $" src="../../form_24.png"/> of a symmetric matrix also modifies the element <img class="formulaInl" alt="$ a_{ji} $" src="../../form_25.png"/>, the matrix to be assigned must be structured such that the symmetry of the symmetric matrix is preserved. Otherwise a <code>std::invalid_argument</code> exception is thrown:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../de/d1e/classblaze_1_1DynamicMatrix.html">blaze::DynamicMatrix</a>;</div><div class="line"><span class="keyword">using</span> <a class="code" href="../../d4/dab/classblaze_1_1SymmetricMatrix.html">blaze::SymmetricMatrix</a>;</div><div class="line"></div><div class="line"><span class="comment">// Setup of two default 4x4 symmetric matrices</span></div><div class="line">SymmetricMatrix&lt; DynamicMatrix&lt;int&gt; &gt; A1( 4 ), A2( 4 );</div><div class="line"></div><div class="line"><span class="comment">// Setup of the 3x2 dynamic matrix</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       ( 1 2 )</span></div><div class="line"><span class="comment">//   B = ( 3 4 )</span></div><div class="line"><span class="comment">//       ( 5 6 )</span></div><div class="line"><span class="comment">//</span></div><div class="line">DynamicMatrix&lt;int&gt; B{ { 1, 2 }, { 3, 4 }, { 5, 6 } };</div><div class="line"></div><div class="line"><span class="comment">// OK: Assigning B to a submatrix of A1 such that the symmetry can be preserved</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//        ( 0 0 1 2 )</span></div><div class="line"><span class="comment">//   A1 = ( 0 0 3 4 )</span></div><div class="line"><span class="comment">//        ( 1 3 5 6 )</span></div><div class="line"><span class="comment">//        ( 2 4 6 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A1, 0UL, 2UL, 3UL, 2UL ) = B;  <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="comment">// Error: Assigning B to a submatrix of A2 such that the symmetry cannot be preserved!</span></div><div class="line"><span class="comment">//   The elements marked with X cannot be assigned unambiguously!</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//        ( 0 1 2 0 )</span></div><div class="line"><span class="comment">//   A2 = ( 1 3 X 0 )</span></div><div class="line"><span class="comment">//        ( 2 X 6 0 )</span></div><div class="line"><span class="comment">//        ( 0 0 0 0 )</span></div><div class="line"><span class="comment">//</span></div><div class="line"><a class="code" href="../../d0/d48/group__views.html#ga92ecd6696c9080d5f3116b91836beb87">submatrix</a>( A2, 0UL, 1UL, 3UL, 2UL ) = B;  <span class="comment">// Assignment throws an exception!</span></div></div><!-- fragment --><p><br />
 Previous: <a class="el" href="../../db/d4b/views_subvectors.html">Subvectors</a> &#160; &#160; Next: <a class="el" href="../../d5/dc1/views_rows.html">Rows</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 18 2017 05:50:23 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
